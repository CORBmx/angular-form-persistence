{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap e242b5eb360245babaec","webpack:///./src/formPersistence.js","webpack:///./src/formPersistence.provider.js","webpack:///./~/store/store.js","webpack:///./src/formPersistence.directive.js"],"names":[],"mappings":"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","file":"angular-form-persistence.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"angular-form-persistence\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"angular-form-persistence\"] = factory();\n\telse\n\t\troot[\"angular-form-persistence\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap e242b5eb360245babaec\n **/","\n// Create module\nlet formPersistence = angular.module('formPersistence', []);\n\nmodule.exports = formPersistence.name;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/formPersistence.js\n **/","import store from 'store';\n\nangular\n    .module('formPersistence')\n    .provider('formPersistence', formPersistence)\n\n\nfunction formPersistence() {\n    this.prefix = 'fp';\n\n    /**\n     * Prefix setter\n     * @author Andrés Ávila <andres.avila@corb.mx>\n     * @version 0.0.1\n     * @since   0.0.1\n     * @param   {string} prefix  prefix attached to all the keys\n     * @return  {object}         provider reference\n     */\n    this.setPrefix = (prefix) => {\n        this.prefix = prefix;\n\n        return this;\n    };\n\n    this.$get = () => {\n        let self = this;\n\n        return {\n            save: saveData,\n            load: loadData,\n            clear: clearKey,\n            clearAll: clearAll,\n        };\n\n        /**\n         * Key prefixer\n         * @author Andrés Ávila <andres.avila@corb.mx>\n         * @version 0.0.1\n         * @since   0.0.1\n         * @param   {string} key  raw key\n         * @return  {string}      prefixed key\n         */\n        function prefixKey(key) {\n            return `${self.prefix}.${key}`;\n        }\n\n        /**\n         * Save data manually in local storage\n         * @author Andrés Ávila <andres.avila@corb.mx>\n         * @version 0.0.1\n         * @since   0.0.1\n         * @param   {string}   key     Data key\n         * @param   {object}   data    Data to be stored\n         * @param   {function} onSave  Optional function to handle the data before is stored\n         */\n        function saveData(key, data, onSave) {\n            let key_name = prefixKey(key);\n\n            data = onSave(data) || data;\n\n            if (Object.getOwnPropertyNames(data).length) {\n                store.set(key_name, data);\n            }\n        }\n\n        /**\n         * Load data from local storage\n         * @author Andrés Ávila <andres.avila@corb.mx>\n         * @version 0.0.1\n         * @since   0.0.1\n         * @param   {string}   key     Data key\n         * @param   {function} onLoad  Optional function to handle the data before is loaded\n         * @return  Data stored or onLoad results\n         */\n        function loadData(key, onLoad) {\n            let data;\n            let key_name = prefixKey(key);\n\n            data = store.get(key_name)\n\n            return onLoad(data) || data;\n        }\n\n        /**\n         * Remove data stored with the given key\n         * @author Andrés Ávila <andres.avila@corb.mx>\n         * @version 0.0.1\n         * @since   0.0.1\n         * @param   {string} key  Data key\n         */\n        function clearKey(key) {\n            store.remove(prefixKey(key));\n        }\n\n        /**\n         * Remove all stored data and keys\n         * @author Andrés Ávila <andres.avila@corb.mx>\n         * @version 0.0.1\n         * @since   0.0.1\n         */\n        function clearAll() {\n            store.clear();\n        }\n    };\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/formPersistence.provider.js\n **/","\"use strict\"\n// Module export pattern from\n// https://github.com/umdjs/umd/blob/master/returnExports.js\n;(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define([], factory);\n    } else if (typeof exports === 'object') {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory();\n    } else {\n        // Browser globals (root is window)\n        root.store = factory();\n  }\n}(this, function () {\n\t\n\t// Store.js\n\tvar store = {},\n\t\twin = (typeof window != 'undefined' ? window : global),\n\t\tdoc = win.document,\n\t\tlocalStorageName = 'localStorage',\n\t\tscriptTag = 'script',\n\t\tstorage\n\n\tstore.disabled = false\n\tstore.version = '1.3.20'\n\tstore.set = function(key, value) {}\n\tstore.get = function(key, defaultVal) {}\n\tstore.has = function(key) { return store.get(key) !== undefined }\n\tstore.remove = function(key) {}\n\tstore.clear = function() {}\n\tstore.transact = function(key, defaultVal, transactionFn) {\n\t\tif (transactionFn == null) {\n\t\t\ttransactionFn = defaultVal\n\t\t\tdefaultVal = null\n\t\t}\n\t\tif (defaultVal == null) {\n\t\t\tdefaultVal = {}\n\t\t}\n\t\tvar val = store.get(key, defaultVal)\n\t\ttransactionFn(val)\n\t\tstore.set(key, val)\n\t}\n\tstore.getAll = function() {}\n\tstore.forEach = function() {}\n\n\tstore.serialize = function(value) {\n\t\treturn JSON.stringify(value)\n\t}\n\tstore.deserialize = function(value) {\n\t\tif (typeof value != 'string') { return undefined }\n\t\ttry { return JSON.parse(value) }\n\t\tcatch(e) { return value || undefined }\n\t}\n\n\t// Functions to encapsulate questionable FireFox 3.6.13 behavior\n\t// when about.config::dom.storage.enabled === false\n\t// See https://github.com/marcuswestin/store.js/issues#issue/13\n\tfunction isLocalStorageNameSupported() {\n\t\ttry { return (localStorageName in win && win[localStorageName]) }\n\t\tcatch(err) { return false }\n\t}\n\n\tif (isLocalStorageNameSupported()) {\n\t\tstorage = win[localStorageName]\n\t\tstore.set = function(key, val) {\n\t\t\tif (val === undefined) { return store.remove(key) }\n\t\t\tstorage.setItem(key, store.serialize(val))\n\t\t\treturn val\n\t\t}\n\t\tstore.get = function(key, defaultVal) {\n\t\t\tvar val = store.deserialize(storage.getItem(key))\n\t\t\treturn (val === undefined ? defaultVal : val)\n\t\t}\n\t\tstore.remove = function(key) { storage.removeItem(key) }\n\t\tstore.clear = function() { storage.clear() }\n\t\tstore.getAll = function() {\n\t\t\tvar ret = {}\n\t\t\tstore.forEach(function(key, val) {\n\t\t\t\tret[key] = val\n\t\t\t})\n\t\t\treturn ret\n\t\t}\n\t\tstore.forEach = function(callback) {\n\t\t\tfor (var i=0; i<storage.length; i++) {\n\t\t\t\tvar key = storage.key(i)\n\t\t\t\tcallback(key, store.get(key))\n\t\t\t}\n\t\t}\n\t} else if (doc && doc.documentElement.addBehavior) {\n\t\tvar storageOwner,\n\t\t\tstorageContainer\n\t\t// Since #userData storage applies only to specific paths, we need to\n\t\t// somehow link our data to a specific path.  We choose /favicon.ico\n\t\t// as a pretty safe option, since all browsers already make a request to\n\t\t// this URL anyway and being a 404 will not hurt us here.  We wrap an\n\t\t// iframe pointing to the favicon in an ActiveXObject(htmlfile) object\n\t\t// (see: http://msdn.microsoft.com/en-us/library/aa752574(v=VS.85).aspx)\n\t\t// since the iframe access rules appear to allow direct access and\n\t\t// manipulation of the document element, even for a 404 page.  This\n\t\t// document can be used instead of the current document (which would\n\t\t// have been limited to the current path) to perform #userData storage.\n\t\ttry {\n\t\t\tstorageContainer = new ActiveXObject('htmlfile')\n\t\t\tstorageContainer.open()\n\t\t\tstorageContainer.write('<'+scriptTag+'>document.w=window</'+scriptTag+'><iframe src=\"/favicon.ico\"></iframe>')\n\t\t\tstorageContainer.close()\n\t\t\tstorageOwner = storageContainer.w.frames[0].document\n\t\t\tstorage = storageOwner.createElement('div')\n\t\t} catch(e) {\n\t\t\t// somehow ActiveXObject instantiation failed (perhaps some special\n\t\t\t// security settings or otherwse), fall back to per-path storage\n\t\t\tstorage = doc.createElement('div')\n\t\t\tstorageOwner = doc.body\n\t\t}\n\t\tvar withIEStorage = function(storeFunction) {\n\t\t\treturn function() {\n\t\t\t\tvar args = Array.prototype.slice.call(arguments, 0)\n\t\t\t\targs.unshift(storage)\n\t\t\t\t// See http://msdn.microsoft.com/en-us/library/ms531081(v=VS.85).aspx\n\t\t\t\t// and http://msdn.microsoft.com/en-us/library/ms531424(v=VS.85).aspx\n\t\t\t\tstorageOwner.appendChild(storage)\n\t\t\t\tstorage.addBehavior('#default#userData')\n\t\t\t\tstorage.load(localStorageName)\n\t\t\t\tvar result = storeFunction.apply(store, args)\n\t\t\t\tstorageOwner.removeChild(storage)\n\t\t\t\treturn result\n\t\t\t}\n\t\t}\n\n\t\t// In IE7, keys cannot start with a digit or contain certain chars.\n\t\t// See https://github.com/marcuswestin/store.js/issues/40\n\t\t// See https://github.com/marcuswestin/store.js/issues/83\n\t\tvar forbiddenCharsRegex = new RegExp(\"[!\\\"#$%&'()*+,/\\\\\\\\:;<=>?@[\\\\]^`{|}~]\", \"g\")\n\t\tvar ieKeyFix = function(key) {\n\t\t\treturn key.replace(/^d/, '___$&').replace(forbiddenCharsRegex, '___')\n\t\t}\n\t\tstore.set = withIEStorage(function(storage, key, val) {\n\t\t\tkey = ieKeyFix(key)\n\t\t\tif (val === undefined) { return store.remove(key) }\n\t\t\tstorage.setAttribute(key, store.serialize(val))\n\t\t\tstorage.save(localStorageName)\n\t\t\treturn val\n\t\t})\n\t\tstore.get = withIEStorage(function(storage, key, defaultVal) {\n\t\t\tkey = ieKeyFix(key)\n\t\t\tvar val = store.deserialize(storage.getAttribute(key))\n\t\t\treturn (val === undefined ? defaultVal : val)\n\t\t})\n\t\tstore.remove = withIEStorage(function(storage, key) {\n\t\t\tkey = ieKeyFix(key)\n\t\t\tstorage.removeAttribute(key)\n\t\t\tstorage.save(localStorageName)\n\t\t})\n\t\tstore.clear = withIEStorage(function(storage) {\n\t\t\tvar attributes = storage.XMLDocument.documentElement.attributes\n\t\t\tstorage.load(localStorageName)\n\t\t\tfor (var i=attributes.length-1; i>=0; i--) {\n\t\t\t\tstorage.removeAttribute(attributes[i].name)\n\t\t\t}\n\t\t\tstorage.save(localStorageName)\n\t\t})\n\t\tstore.getAll = function(storage) {\n\t\t\tvar ret = {}\n\t\t\tstore.forEach(function(key, val) {\n\t\t\t\tret[key] = val\n\t\t\t})\n\t\t\treturn ret\n\t\t}\n\t\tstore.forEach = withIEStorage(function(storage, callback) {\n\t\t\tvar attributes = storage.XMLDocument.documentElement.attributes\n\t\t\tfor (var i=0, attr; attr=attributes[i]; ++i) {\n\t\t\t\tcallback(attr.name, store.deserialize(storage.getAttribute(attr.name)))\n\t\t\t}\n\t\t})\n\t}\n\n\ttry {\n\t\tvar testKey = '__storejs__'\n\t\tstore.set(testKey, testKey)\n\t\tif (store.get(testKey) != testKey) { store.disabled = true }\n\t\tstore.remove(testKey)\n\t} catch(e) {\n\t\tstore.disabled = true\n\t}\n\tstore.enabled = !store.disabled\n\t\n\treturn store\n}));\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/store/store.js\n ** module id = 3\n ** module chunks = 0\n **/","angular\n    .module('formPersistence')\n    .directive('formPersistence', formPersistence);\n\nconst DEBOUND_DELAY = 400;\n\n/**\n * formPersistence directive\n * @author Andrés Ávila <andres.avila@corb.mx>\n * @version 0.0.1\n * @since   0.0.1\n * @param   {object} $timeout               Timeout service\n * @param   {object} formPersistence        formPersistence service\n * @return  {object}                        Directive instance\n */\nfunction formPersistence($timeout, formPersistence) {\n    'ngInject';\n\n    return {\n        restrict: 'A',\n        scope: {\n            key: '@formPersistence',\n            data: '=saveData',\n            onSave: '&?beforeSave',\n            onLoad: '&?beforeLoad'\n        },\n        link: function (scope) {\n            let debound;\n\n            scope.data = formPersistence.load(scope.key, scope.onLoad);\n\n            scope.$watch(() => {\n                return scope.data;\n            }, handleModelChange, true);\n\n            /**\n             * Changes handler\n             * @author Andrés Ávila <andres.avila@corb.mx>\n             * @version 0.0.1\n             * @since   0.0.1\n             */\n            function handleModelChange() {\n                let data;\n                let key;\n\n                key = scope.key;\n\n                if (angular.isObject()) {\n                    // copy object\n                    data = {...scope.data};\n                }\n\n                if (debound) {\n                    $timeout.cancel(debound);\n                }\n\n                debound = $timeout(() => {\n                    formPersistence.save(key, data, scope.onSave);\n                }, DEBOUND_DELAY);\n            }\n        }\n    }\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/formPersistence.directive.js\n **/"],"sourceRoot":""}